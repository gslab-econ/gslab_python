running pytest
running egg_info
writing requirements to GSLab_Tools.egg-info/requires.txt
writing GSLab_Tools.egg-info/PKG-INFO
writing top-level names to GSLab_Tools.egg-info/top_level.txt
writing dependency_links to GSLab_Tools.egg-info/dependency_links.txt
reading manifest file 'GSLab_Tools.egg-info/SOURCES.txt'
writing manifest file 'GSLab_Tools.egg-info/SOURCES.txt'
running build_ext
============================= test session starts ==============================
platform darwin -- Python 2.7.13, pytest-3.2.1, py-1.4.34, pluggy-0.4.0
rootdir: /Users/chuanyu/Desktop/gslab_python, inifile:
collected 129 items

gencat/tests/test_checkDicts.py ...
gencat/tests/test_cleanDir.py ......
gencat/tests/test_main.py .
gencat/tests/test_unzipFiles.py ......
gencat/tests/test_writeDict.py ....
gencat/tests/test_zipFile.py ....
gslab_fill/tests/test_tablefill.py ....
gslab_fill/tests/test_textfill.py ........
gslab_scons/tests/test_build_latex.py ......
gslab_scons/tests/test_build_lyx.py ......
gslab_scons/tests/test_build_matlab.py ......
gslab_scons/tests/test_build_python.py ......
gslab_scons/tests/test_build_r.py .F.FF
gslab_scons/tests/test_build_stata.py ..........
gslab_scons/tests/test_build_tables.py .....
gslab_scons/tests/test_configuration_tests.py .........
gslab_scons/tests/test_log.py F........
gslab_scons/tests/test_misc.py ..................
gslab_scons/tests/test_release_function.py ....
gslab_scons/tests/test_release_tools.py ....
gslab_scons/tests/test_size_warning.py .....

=================================== FAILURES ===================================
____________________________ TestBuildR.test_cl_arg ____________________________

self = <gslab_scons.tests.test_build_r.TestBuildR testMethod=test_cl_arg>
mock_check_output = <MagicMock name='check_output' id='4371541456'>

    @system_patch
    def test_cl_arg(self, mock_check_output):
        mock_check_output.side_effect = fx.make_r_side_effect(True)
>       helpers.test_cl_args(self, gs.build_r, mock_check_output, 'R')

test_build_r.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
_test_helpers.py:196: in test_cl_args
    builder(source = source, target = target, env = env)
../builders/build_r.py:46: in build_r
    shell  = True)
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/mock/mock.py:1062: in __call__
    return _mock_self._mock_call(*args, **kwargs)
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/mock/mock.py:1128: in _mock_call
    ret_val = effect(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = ('Rscript --no-save --no-restore --verbose ./test_script.R test > ./sconscript.log 2>&1',)
kwargs = {'shell': True, 'stderr': -2}
command = 'Rscript --no-save --no-restore --verbose ./test_script.R test > ./sconscript.log 2>&1'
match = None

    def side_effect(*args, **kwargs):
        '''
            This side effect mocks the behaviour of a subprocess.check_output()
            call on a machine with R set up for command-line use.
            '''
        # Get and parse the command passed to os.system()
        command = args[0]
        if re.search('R', command, flags = re.I) and not recognized:
            raise subprocess.CalledProcessError(1, command)
    
        match   = helpers.command_match(command, 'R')
    
>       executable = match.group('executable')
E       AttributeError: 'NoneType' object has no attribute 'group'

_side_effects.py:28: AttributeError
___________________________ TestBuildR.test_standard ___________________________

self = <gslab_scons.tests.test_build_r.TestBuildR testMethod=test_standard>
mock_check_output = <MagicMock name='check_output' id='4370462032'>

    @system_patch
    def test_standard(self, mock_check_output):
        '''Test build_r()'s behaviour when given standard inputs.'''
        mock_check_output.side_effect = fx.make_r_side_effect(True)
        helpers.standard_test(self, gs.build_r, 'R',
>                             system_mock = mock_check_output)

test_build_r.py:35: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
_test_helpers.py:149: in standard_test
    builder(source = source, target = target, env = env)
../builders/build_r.py:46: in build_r
    shell  = True)
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/mock/mock.py:1062: in __call__
    return _mock_self._mock_call(*args, **kwargs)
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/mock/mock.py:1128: in _mock_call
    ret_val = effect(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = ('Rscript --no-save --no-restore --verbose ./test_script.R  > ./sconscript.log 2>&1',)
kwargs = {'shell': True, 'stderr': -2}
command = 'Rscript --no-save --no-restore --verbose ./test_script.R  > ./sconscript.log 2>&1'
match = None

    def side_effect(*args, **kwargs):
        '''
            This side effect mocks the behaviour of a subprocess.check_output()
            call on a machine with R set up for command-line use.
            '''
        # Get and parse the command passed to os.system()
        command = args[0]
        if re.search('R', command, flags = re.I) and not recognized:
            raise subprocess.CalledProcessError(1, command)
    
        match   = helpers.command_match(command, 'R')
    
>       executable = match.group('executable')
E       AttributeError: 'NoneType' object has no attribute 'group'

_side_effects.py:28: AttributeError
______________________ TestBuildR.test_unintended_inputs _______________________

self = <gslab_scons.tests.test_build_r.TestBuildR testMethod=test_unintended_inputs>
mock_check_output = <MagicMock name='check_output' id='4370265680'>

    @system_patch
    def test_unintended_inputs(self, mock_check_output):
        # We expect build_r() to raise an error if its env
        # argument does not support indexing by strings.
        mock_check_output.side_effect = fx.make_r_side_effect(True)
    
        check = lambda **kwargs: helpers.input_check(self, gs.build_r,
                                                     'r', **kwargs)
    
        for bad_env in [True, (1, 2), TypeError]:
            check(env = bad_env, error = TypeError)
    
        for bad_target in (None, 1):
            check(target = bad_target, error = TypeError)
        check(target = [], error = IndexError)
    
>       check(target = '', error = None)

test_build_r.py:80: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
test_build_r.py:71: in <lambda>
    'r', **kwargs)
_test_helpers.py:175: in input_check
    builder(source = source, target = target, env = env)
../builders/build_r.py:46: in build_r
    shell  = True)
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/mock/mock.py:1062: in __call__
    return _mock_self._mock_call(*args, **kwargs)
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/mock/mock.py:1128: in _mock_call
    ret_val = effect(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = ('Rscript --no-save --no-restore --verbose test_script.r  > ./sconscript.log 2>&1',)
kwargs = {'shell': True, 'stderr': -2}
command = 'Rscript --no-save --no-restore --verbose test_script.r  > ./sconscript.log 2>&1'
match = None

    def side_effect(*args, **kwargs):
        '''
            This side effect mocks the behaviour of a subprocess.check_output()
            call on a machine with R set up for command-line use.
            '''
        # Get and parse the command passed to os.system()
        command = args[0]
        if re.search('R', command, flags = re.I) and not recognized:
            raise subprocess.CalledProcessError(1, command)
    
        match   = helpers.command_match(command, 'R')
    
>       executable = match.group('executable')
E       AttributeError: 'NoneType' object has no attribute 'group'

_side_effects.py:28: AttributeError
_____________________________ TestLog.test_end_log _____________________________

self = <gslab_scons.tests.test_log.TestLog testMethod=test_end_log>
mock_time = <MagicMock name='current_time' id='4371628304'>

    @mock.patch('gslab_scons.log.misc.current_time')
    def test_end_log(self, mock_time):
        # Mock the current time
        now = '2000-01-01 0:0:0'
        mock_time.return_value = now
>       gs.end_log()

test_log.py:184: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../log.py:64: in end_log
    shutil.move('./' + file, 'release/' + file)
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/shutil.py:302: in move
    copy2(src, real_dst)
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/shutil.py:130: in copy2
    copyfile(src, dst)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

src = './sconstruct.log', dst = 'release/sconstruct.log'

    def copyfile(src, dst):
        """Copy data from src to dst"""
        if _samefile(src, dst):
            raise Error("`%s` and `%s` are the same file" % (src, dst))
    
        for fn in [src, dst]:
            try:
                st = os.stat(fn)
            except OSError:
                # File most likely does not exist
                pass
            else:
                # XXX What about other special files? (sockets, devices...)
                if stat.S_ISFIFO(st.st_mode):
                    raise SpecialFileError("`%s` is a named pipe" % fn)
    
        with open(src, 'rb') as fsrc:
>           with open(dst, 'wb') as fdst:
E           IOError: [Errno 2] No such file or directory: 'release/sconstruct.log'

/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/shutil.py:83: IOError
===================== 4 failed, 125 passed in 2.86 seconds =====================
Name                                            Stmts   Miss Branch BrPart  Cover   Missing
-------------------------------------------------------------------------------------------
gencat/gencat.py                                   79      6     28      4    91%   72-73, 81, 89, 97, 101, 57->exit, 71->72, 96->97, 100->101
gencat/tests/run_all_tests.py                       9      9      0      0     0%   3-14
gencat/tests/test_checkDicts.py                    55      4      6      1    92%   20-22, 80, 79->80
gencat/tests/test_cleanDir.py                      56      6      6      1    89%   15, 18, 31-33, 94, 93->94
gencat/tests/test_main.py                          49      4      8      1    91%   32-34, 71, 70->71
gencat/tests/test_unzipFiles.py                   124      6     30      2    95%   15, 17, 30-32, 194, 156->150, 193->194
gencat/tests/test_writeDict.py                     60      6      8      1    90%   15, 17, 30-32, 92, 91->92
gencat/tests/test_zipFile.py                      101      6      8      1    94%   16, 19, 28-30, 149, 148->149
gslab_fill/tablefill.py                           107      4     44      7    93%   53, 100, 134, 137, 32->35, 35->37, 52->53, 85->82, 99->100, 130->134, 136->137
gslab_fill/tablefill_info.py                        0      0      0      0   100%
gslab_fill/tests/test_tablefill.py                 70      2     16      4    93%   118-119, 22->exit, 52->exit, 113->exit, 117->118
gslab_fill/tests/test_textfill.py                  84      2     12      3    95%   139-140, 18->exit, 134->exit, 138->139
gslab_fill/textfill.py                            135      2     60      5    96%   44, 170, 32->35, 35->37, 43->44, 100->exit, 169->170
gslab_fill/textfill_info.py                         0      0      0      0   100%
gslab_make/dir_mod.py                             151    130     70      0    10%   28-31, 43-54, 69-145, 159-205, 216-220, 224-226, 230-237, 241-249
gslab_make/get_externals.py                        22     16      2      0    25%   78-98
gslab_make/get_externals_github.py                 22     15      2      0    29%   57-79
gslab_make/make_link_logs.py                       36     28     16      0    15%   61-75, 86-106
gslab_make/make_links.py                           18     12      4      0    27%   60-78
gslab_make/make_log.py                            166    146     66      0     9%   35-63, 77-100, 113-128, 146-172, 191-217, 250-262, 279-297, 313-345
gslab_make/private/exceptionclasses.py             11      2      0      0    82%   5, 7
gslab_make/private/getexternalsdirectives.py      200    167     86      0    12%   17-23, 26-44, 48-49, 53-55, 59-70, 74-75, 79-83, 87-108, 112-123, 127, 136-151, 155-204, 208, 213-217, 222-230, 239-253, 257-264, 269-278, 286-299, 303-307, 311-316
gslab_make/private/linkdirectives.py              108     92     56      0    10%   14-34, 39-44, 48-49, 53-62, 66-87, 90-102, 106-114, 117-140, 144-157
gslab_make/private/linkslist.py                    55     46     30      0    11%   13-42, 45-49, 52-70
gslab_make/private/messages.py                     48      0      0      0   100%
gslab_make/private/metadata.py                      9      0      0      0   100%
gslab_make/private/preliminaries.py               107     88     40      0    13%   17-26, 29-38, 43-56, 60-64, 67-72, 81-90, 97-113, 120-141, 144-146, 151-160
gslab_make/private/runprogramdirective.py         207    185    104      0     7%   16-93, 97-107, 111-116, 121-134, 138-145, 149-163, 167-220, 224-240, 244-264, 271-282, 285-289, 296-302
gslab_make/run_program.py                         238    217     80      0     7%   129-162, 178-202, 208-225, 231-248, 254-275, 281-298, 304-321, 332-392, 398-423, 429-447, 453-488, 494-499
gslab_make/tests/nostderrout.py                    12      0      2      0   100%
gslab_scons/_exception_classes.py                  11      0      0      0   100%
gslab_scons/_release_tools.py                     132      0     46      1    99%   34->37
gslab_scons/builders/build_latex.py                29      0      0      0   100%
gslab_scons/builders/build_lyx.py                  30      0      0      0   100%
gslab_scons/builders/build_matlab.py               38      0      4      0   100%
gslab_scons/builders/build_python.py               28      0      0      0   100%
gslab_scons/builders/build_r.py                    28      3      0      0    89%   51-54
gslab_scons/builders/build_stata.py                36      0      2      0   100%
gslab_scons/builders/build_tables.py               31      0      2      0   100%
gslab_scons/configuration_tests.py                 91      0     32      0   100%
gslab_scons/log.py                                 77     22     18      4    71%   54-60, 65, 90, 95-96, 100-111, 53->54, 63->65, 87->90, 99->100
gslab_scons/misc.py                               174      3     60      2    98%   242-243, 274, 241->242, 273->274
gslab_scons/release.py                             41     41     20      0     0%   1-72
gslab_scons/size_warning.py                        70      0     30      0   100%
gslab_scons/tests/_side_effects.py                136      8     32      7    89%   29-39, 119, 49->exit, 73->78, 144->156, 160->exit, 190->202, 206->exit, 291->297
gslab_scons/tests/_test_helpers.py                 97      6     36      5    90%   27-28, 116, 131, 202, 218, 88->102, 113->116, 126->131, 201->202, 217->218
gslab_scons/tests/test_build_latex.py              52      1      8      3    93%   108, 26->exit, 103->exit, 107->108
gslab_scons/tests/test_build_lyx.py                52      1      8      3    93%   108, 26->exit, 103->exit, 107->108
gslab_scons/tests/test_build_matlab.py             54      1      6      1    97%   110, 109->110
gslab_scons/tests/test_build_python.py             60      2     14      4    92%   75, 107, 23->exit, 74->75, 102->exit, 106->107
gslab_scons/tests/test_build_r.py                  46      3     12      3    90%   38-39, 88, 27->exit, 83->exit, 87->88
gslab_scons/tests/test_build_stata.py              82      1      2      1    98%   161, 160->161
gslab_scons/tests/test_build_tables.py             88      2     12      3    95%   144, 178, 21->exit, 173->exit, 177->178
gslab_scons/tests/test_configuration_tests.py     194      2     54      4    98%   211, 313, 107->exit, 206->213, 208->211, 312->313
gslab_scons/tests/test_log.py                     112     14     12      3    83%   27, 152-158, 185-188, 194, 198, 26->27, 193->194, 197->198
gslab_scons/tests/test_misc.py                    192      2     28      6    96%   179, 363, 178->179, 282->exit, 289->exit, 314->exit, 342->exit, 362->363
gslab_scons/tests/test_release_function.py        121      3     22      2    97%   293-294, 324, 184->exit, 323->324
gslab_scons/tests/test_release_tools.py            64      1      2      1    97%   153, 152->153
gslab_scons/tests/test_size_warning.py            183      5     46      6    95%   277, 294, 310, 374, 380, 273->277, 274->277, 293->294, 305->310, 371->374, 379->380
-------------------------------------------------------------------------------------------
TOTAL                                            4688   1322   1292     89    67%
